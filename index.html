<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…« 4 ç­å…¨æ™¯å›¾</title>
    <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            overflow: hidden;
            background-color: #000;
        }
        
        #panorama {
            width: 100vw;
            height: 100vh;
        }
        
        /* é¡¶éƒ¨æ§åˆ¶æ  */
        .top-controls {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 100;
        }
        
        .top-controls .back-btn {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .top-controls .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        .top-controls .title {
            color: white;
            font-size: 18px;
            font-weight: 500;
        }
        
        .top-controls .music-btn {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }
        
        .music-btn.playing {
            animation: rotate 2s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* åº•éƒ¨æ§åˆ¶æ  */
        .bottom-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 20px;
            z-index: 100;
        }
        
        .share-btn {
            background: rgba(52, 152, 219, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .share-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }
        
        .share-btn:hover::before {
            width: 200px;
            height: 200px;
        }
        
        .share-btn:active {
            background: rgba(41, 128, 185, 1);
        }
        
        /* è§‚çœ‹äººæ•°ï¼ˆHitWebCounterï¼‰ */
        .view-count {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* éšè—HitWebCounteré»˜è®¤çš„è¾¹æ¡†å’ŒèƒŒæ™¯ */
        .hitwebcounter {
            border: none !important;
            background: transparent !important;
        }
        
        /* ç£¨ç ‚ç»ç’ƒæ•ˆæœ */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 16px;
        }
    </style>
</head>
<body>
    <div id="panorama"></div>
    
    <div class="top-controls">
        <button class="back-btn glass">è¿”å›</button>
        <div class="title">å…« 4 ç­å…¨æ™¯å›¾</div>
        <button class="music-btn glass" id="musicBtn">ğŸµ</button>
    </div>
    
    <div class="bottom-controls">
        <button class="share-btn" id="shareBtn">åˆ†äº«å½“å‰è§†è§’</button>
    </div>
    
    <!-- HitWebCounter åœ¨çº¿è®¡æ•°å™¨ï¼ˆæ·¡ç™½è‰²ã€å°å°ºå¯¸ï¼‰ -->
    <div class="view-count">
        è§‚çœ‹äººæ•°:
        <a href="https://www.hitwebcounter.com" target="_blank">
            <img src="https://hitwebcounter.com/counter/counter.php?page=21459113&style=0032&nbdigits=3&type=page&initCount=0" 
                 alt="è§‚çœ‹äººæ•°ç»Ÿè®¡" 
                 class="hitwebcounter" 
                 border="0" 
                 title="è§‚çœ‹äººæ•°ç»Ÿè®¡" 
                 style="width: auto; height: 14px;">
        </a>
    </div>
    
    <audio id="backgroundMusic" loop>
        <source src="background-music.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    
    <script>
        // åˆå§‹åŒ–å…¨æ™¯å›¾ï¼ˆå·²æ›¿æ¢ä¸ºä½ çš„ç½‘ç»œå›¾ç‰‡é“¾æ¥ï¼‰
        const viewer = pannellum.viewer('panorama', {
            type: 'equirectangular',
            panorama: 'classroom-panorama.jpg',
            autoLoad: true,
            controls: true,
            mouseZoom: true,
            touchZoom: true,
            compass: false,
            autoRotate: 0,
            showFullscreenCtrl: false,
            showZoomCtrl: false
        });
        
        // éŸ³ä¹æ’­æ”¾æ§åˆ¶ï¼ˆè‡ªåŠ¨æ’­æ”¾ï¼‰
        const musicBtn = document.getElementById('musicBtn');
        const backgroundMusic = document.getElementById('backgroundMusic');
        
        window.addEventListener('load', () => {
            backgroundMusic.play().then(() => {
                musicBtn.classList.add('playing');
            }).catch(error => {
                console.log('è‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼ˆæµè§ˆå™¨é™åˆ¶ï¼‰ï¼Œå¯æ‰‹åŠ¨ç‚¹å‡»éŸ³ä¹æŒ‰é’®æ’­æ”¾:', error);
            });
        });
        
        musicBtn.addEventListener('click', () => {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                musicBtn.classList.add('playing');
            } else {
                backgroundMusic.pause();
                musicBtn.classList.remove('playing');
            }
        });
        
        // åˆ†äº«åŠŸèƒ½ï¼ˆä¸‹è½½å½“å‰è§†è§’å›¾ç‰‡ï¼‰
        const shareBtn = document.getElementById('shareBtn');
        shareBtn.addEventListener('click', () => {
            html2canvas(document.getElementById('panorama')).then(canvas => {
                const imageURL = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = imageURL;
                link.download = 'å…«4ç­å…¨æ™¯å›¾-å½“å‰è§†è§’.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                alert('å½“å‰è§†è§’å›¾ç‰‡å·²å¼€å§‹ä¸‹è½½ï¼');
            });
        });
        
        // è¿”å›æŒ‰é’®åŠŸèƒ½
        const backBtn = document.querySelector('.back-btn');
        backBtn.addEventListener('click', () => {
            window.history.back();
        });
    </script>
</body>
</html>
